services:
  openclaw-image:
    build: ${OPENCLAW_REPO_PATH:-../openclaw}
    image: openclaw:latest
    profiles: ["build"]

  manager:
    build: ./manager
    restart: unless-stopped
    ports:
      - "8100:8100"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ${OPENCLAW_DATA_DIR:-/opt/openclaw/data}:/opt/openclaw/data
      - ./skills:/opt/openclaw/shared/skills:ro
    environment:
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
      - GROQ_API_KEY=${GROQ_API_KEY}
      - MANAGER_TOKEN=${MANAGER_TOKEN}
      - OPENCLAW_IMAGE=${OPENCLAW_IMAGE:-openclaw:latest}
      - HOST_DATA_DIR=${OPENCLAW_DATA_DIR:-/opt/openclaw/data}
    networks:
      - openclaw-net

networks:
  openclaw-net:
    name: openclaw-net
    driver: bridge
