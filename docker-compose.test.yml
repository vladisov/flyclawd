services:
  openclaw:
    image: node:22-slim
    command: >
      sh -c "apt-get update && apt-get install -y git &&
        npm install -g openclaw &&
        [ -f /root/.openclaw/openclaw.json ] || cp /config-source/openclaw.json /root/.openclaw/openclaw.json &&
        openclaw gateway"
    restart: unless-stopped
    ports:
      - "18789:18789"
    volumes:
      - openclaw-data-test:/root/.openclaw
      - ./config/openclaw.json:/config-source/openclaw.json:ro
      - ./config/admin-workspace:/root/.openclaw/workspace
      - ./skills:/root/.openclaw/skills
    environment:
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - GATEWAY_TOKEN=${GATEWAY_TOKEN}
      - ENV=test

volumes:
  openclaw-data-test:
    driver: local
